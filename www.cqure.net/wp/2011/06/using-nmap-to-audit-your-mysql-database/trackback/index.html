<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head profile="http://gmpg.org/xfn/11">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<title>cqure.net  &raquo; Blog Archive   &raquo; Using Nmap to audit your MySQL database</title>

<meta name="generator" content="WordPress 3.4.1" /> <!-- leave this for stats -->

<link rel="stylesheet" href="../../../../wp-content/themes/cqure2/style.css" type="text/css" media="screen" />
<link rel="alternate" type="application/rss+xml" title="RSS 2.0" href="../../../../feed/rss/index.html" />
<link rel="alternate" type="text/xml" title="RSS .92" href="../../../../feed/rss/index.html" />
<link rel="alternate" type="application/atom+xml" title="Atom 0.3" href="../../../../feed/atom/index.html" />
<link rel="pingback" href="../../../../xmlrpc.php" />

	<link rel='archives' title='July 2012' href='../../../../2012/07/index.html' />
	<link rel='archives' title='May 2012' href='../../../../2012/05/index.html' />
	<link rel='archives' title='August 2011' href='../../../08/index.html' />
	<link rel='archives' title='June 2011' href='../../index.html' />
	<link rel='archives' title='February 2011' href='../../../02/index.html' />
	<link rel='archives' title='January 2011' href='../../../01/index.html' />
	<link rel='archives' title='August 2010' href='../../../../2010/08/index.html' />
	<link rel='archives' title='May 2010' href='../../../../2010/05/index.html' />
	<link rel='archives' title='March 2010' href='../../../../2010/03/index.html' />
	<link rel='archives' title='February 2010' href='../../../../2010/02/index.html' />
	<link rel='archives' title='January 2010' href='../../../../2010/01/index.html' />
	<link rel='archives' title='December 2009' href='../../../../2009/12/index.html' />
	<link rel='archives' title='November 2009' href='../../../../2009/11/index.html' />
	<link rel='archives' title='October 2009' href='../../../../2009/10/index.html' />
	<link rel='archives' title='September 2009' href='../../../../2009/09/index.html' />
	<link rel='archives' title='May 2009' href='../../../../2009/05/index.html' />
	<link rel='archives' title='September 2008' href='../../../../2008/09/index.html' />
	<link rel='archives' title='August 2008' href='../../../../2008/08/index.html' />
	<link rel='archives' title='May 2008' href='../../../../2008/05/index.html' />
	<link rel='archives' title='April 2008' href='../../../../2008/04/index.html' />
	<link rel='archives' title='November 2007' href='../../../../2007/11/index.html' />
	<link rel='archives' title='October 2007' href='../../../../2007/10/index.html' />
	<link rel='archives' title='September 2007' href='../../../../2007/09/index.html' />
	<link rel='archives' title='August 2007' href='../../../../2007/08/index.html' />
	<link rel='archives' title='July 2007' href='../../../../2007/07/index.html' />
	<link rel='archives' title='March 2007' href='../../../../2007/03/index.html' />
	<link rel='archives' title='February 2007' href='../../../../2007/02/index.html' />
	<link rel='archives' title='January 2007' href='../../../../2007/01/index.html' />
	<link rel='archives' title='November 2006' href='../../../../2006/11/index.html' />
	<link rel='archives' title='October 2006' href='../../../../2006/10/index.html' />
	<link rel='archives' title='March 2006' href='../../../../2006/03/index.html' />
	<link rel='archives' title='February 2006' href='../../../../2006/02/index.html' />
	<link rel='archives' title='January 2006' href='../../../../2006/01/index.html' />

<link rel="alternate" type="application/rss+xml" title="cqure.net &raquo; Using Nmap to audit your MySQL database Comments Feed" href="../feed/index.html" />
<link rel='stylesheet' id='A2A_SHARE_SAVE-css'  href='../../../../wp-content/plugins/add-to-any/addtoany.min.css?ver=1.4' type='text/css' media='all' />
<script type='text/javascript' src='http://ajax.googleapis.com/ajax/libs/swfobject/2.2/swfobject.js?ver=3.4.1'></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="../../../../xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="../../../../wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='Pulling Cisco configs with Nmap' href='../../../02/pulling-cisco-configs-with-nmap/trackback/index.html' />
<link rel='next' title='Using Nmap for pentesting eDirectory' href='../../using-nmap-for-pentesting-edirectory/trackback/index.html' />
<link rel='canonical' href='index.html' />
<link rel='shortlink' href='../../../../index.html?p=439' />

<script type="text/javascript"><!--
var a2a_config=a2a_config||{},wpa2a={done:false,html_done:false,script_ready:false,script_load:function(){var a=document.createElement('script'),s=document.getElementsByTagName('script')[0];a.type='text/javascript';a.async=true;a.src='http://static.addtoany.com/menu/page.js';s.parentNode.insertBefore(a,s);wpa2a.script_load=function(){};},script_onready:function(){if(a2a.type=='page'){wpa2a.script_ready=true;if(wpa2a.html_done)wpa2a.init();}},init:function(){for(var i=0,el,target,targets=wpa2a.targets,length=targets.length;i<length;i++){el=document.getElementById('wpa2a_'+(i+1));target=targets[i];a2a_config.linkname=target.title;a2a_config.linkurl=target.url;if(el)a2a.init('page',{target:el});wpa2a.done=true;}}};a2a_config.tracking_callback=['ready',wpa2a.script_onready];
//--></script>
<script type="text/javascript">
	swfobject.registerObject("wpFollowmeFlash", "9.0.0");
</script>
<style type="text/css">
	.getflash { font-size:8px; }
	.wp_followme_c2 {
		position:fixed;
		background:#59B7FF;
		top:200px;
		right:0px;
		width:32px;
		height:160px;
		border:1px solid #FFFFFF;
		color:#FFFFFF;
	}
</style>

<!--[if IE]>
<style type="text/css">
.addtoany_list a img{filter:alpha(opacity=70)}
.addtoany_list a:hover img,.addtoany_list a.addtoany_share_save img{filter:alpha(opacity=100)}
</style>
<![endif]-->
</head>
<body background="../../../../wp-content/themes/cqure2/images/eye.jpg">

<div class="title"><a href="../../../../../wp.1">cqure.net</a></div>
<div class="description"></div>
<div id="page">
<br>
<div class="top-ad">
<script type="text/javascript"><!--
google_ad_client = "pub-5587712415782238";
//Link unit below logo 728x15
google_ad_slot = "9173520977";
google_ad_width = 728;
google_ad_height = 15;
//--></script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</div>

<!-- Start Obar -->

	<div class="obar">
<ul>

<script type="text/javascript"><!--
google_ad_client = "pub-5587712415782238";
//120x600, created 11/8/07
google_ad_slot = "9346871999";
google_ad_width = 120;
google_ad_height = 600;
//--></script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</ul>
	</div>

<!-- End Obar -->

	<div id="content" class="widecolumn">
				
  	
		<div class="navigation">
			<div class="alignleft">&laquo; <a href="../../../02/pulling-cisco-configs-with-nmap/trackback/index.html" rel="prev">Pulling Cisco configs with Nmap</a></div>
			<div class="alignright"><a href="../../using-nmap-for-pentesting-edirectory/trackback/index.html" rel="next">Using Nmap for pentesting eDirectory</a> &raquo;</div>
		</div>
	
		<div class="post" id="post-439">
			<h2><a href="index.html" rel="bookmark" title="Permanent Link: Using Nmap to audit your MySQL database">Using Nmap to audit your MySQL database</a></h2>
	
			<div class="entrytext">
				<p>I&#8217;ve been working on a Nmap script for auditing MySQL databases against the CIS 1.0.2 benchmark for a while. I haven&#8217;t committed it to subversion yet, but it&#8217;s available to download for anyone who feels up to testing it. While it isn&#8217;t perfect nor does it contain all CIS controls, it provides Nmap users with the possibility to quickly scan a database to see whether it complies with the CIS recommendations or not.</p>
<p><span id="more-439"></span>The script is comprised of two parts; the engine and the rulebase. The engine (mysql-audit.nse) simply reads the rulebase (mysql-cis.audit) which contains all of the checks. The rulebase is quite simple and contains a few supporting functions making it trivial to add more rules to it.</p>
<p>The script and rulebase can be downloaded from <a href="http://seclists.org/nmap-dev/2011/q2/814">nmap-dev</a> and the files need to be copied to the correct directories in order to run. The script file (mysql-audit.nse) goes into the nmap script directory and the audit file could really go anywhere but I&#8217;ve copied it into the nselib/data directory.</p>
<p>In order to run, the script needs the following parameters:</p>
<ol>
<li>the hostname against which it&#8217;s supposed to run</li>
<li>the port on which the MySQL database is running</li>
<li>the username and password of a privileged account (eg. the MySQL root account)</li>
</ol>
<p>The following command (contains line breaks for readability) instructs Nmap to scan the database at 1.2.3.4 on port 3306 using the username root and password foobar:</p>
<pre lang="bash">nmap -p 3306 1.2.3.4 --script mysql-audit \
--script-args "mysql-audit.filename='nselib/data/mysql-cis.audit'\
,mysql-audit.username='root',mysql-audit.password='foobar'"</pre>
<p>The result should look something similar to this:</p>
<pre>| mysql-audit:
|   CIS MySQL Benchmark v1.0.2
|       3.1: Skip symbolic links =&gt; PASS
|       3.2: Logs not on system partition =&gt; PASS
|       3.2: Logs not on database partition =&gt; PASS
|       4.1: Supported version of MySQL =&gt; REVIEW
|         Version: 5.1.54-1ubuntu4
|       4.4: Remove test database =&gt; PASS
|       4.5: Change admin account name =&gt; FAIL
|       4.7: Verify Secure Password Hashes =&gt; PASS
|       4.9: Wildcards in user hostname =&gt; FAIL
|         The following users were found with wildcards in hostname
|           root
|           super
|           super2
|       4.10: No blank passwords =&gt; PASS
.
.
.</pre>
<p>I&#8217;m interested in both bug reports and success stories, so let me know of your results.</p>
<div class="addtoany_share_save_container"><div class="a2a_kit a2a_target addtoany_list" id="wpa2a_1"><a class="a2a_dd addtoany_share_save" href="http://www.addtoany.com/share_save"><img src="../../../../wp-content/plugins/add-to-any/share_save_171_16.png" width="171" height="16" alt="Share"/></a></div>
<script type="text/javascript"><!--
wpa2a.script_load();
//--></script>
</div>	
					
				<p class="postmetadata alt">
					<small>
						This entry was posted
						 
						on Sunday, June 5th, 2011 at 2:54 pm						and is filed under <a href="../../../../category/nmap-2/index.html" title="View all posts in Nmap" rel="category tag">Nmap</a>.
						You can follow any responses to this entry through the <a href='../feed/index.html'>RSS 2.0</a> feed. 
						
													You can <a href="index.html#respond">leave a response</a>, or <a href="index.html" rel="trackback">trackback</a> from your own site.
						
												
					</small>
				</p>
	
			</div>
		</div>
		
	
<!-- You can start editing here. -->

	<h3 id="comments">2 Responses to &#8220;Using Nmap to audit your MySQL database&#8221;</h3> 

	<ol class="commentlist">

	
		<li class="alt" id="comment-524">
			<cite><a href='http://www.zonbi.org/?p=663' rel='external nofollow' class='url'>Undead Security / Monday Catchup &#8211; 06/06/2011</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="index.html#comment-524" title="">June 6th, 2011 at 4:34 am</a> </small>

			<p>[...] Auditing MySQL with Nmap: <a href="index.html" rel="nofollow">http://www.cqure.net/wp/2011/06/using-nmap-to-audit-your-mysql-database/</a> [...]</p>

		</li>

	
	
		<li class="" id="comment-528">
			<cite><a href='http://www.itsecuresite.com/general/monday-catchup-%e2%80%93-06062011.html' rel='external nofollow' class='url'>IT Secure Site &raquo; Monday Catchup â€“ 06/06/2011</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="index.html#comment-528" title="">June 11th, 2011 at 7:58 pm</a> </small>

			<p>[...] Auditing MySQL with Nmap: <a href="index.html" rel="nofollow">http://www.cqure.net/wp/2011/06/using-nmap-to-audit-your-mysql-database/</a> [...]</p>

		</li>

	
	
	</ol>

 


<h3 id="respond">Leave a Reply</h3>

<p>You must be <a href="http://www.cqure.net/wp/wp-login.php?redirect_to=http://www.cqure.net/wp/2011/06/using-nmap-to-audit-your-mysql-database/">logged in</a> to post a comment.</p>

	
		
	</div>


<hr />
<div id="footer">
	<p>
		cqure.net is proudly powered by 
		<a href="http://wordpress.org">WordPress</a>
		<br /><a href="feed:http://www.cqure.net/wp/feed/">Entries (RSS)</a>
		and <a href="feed:http://www.cqure.net/wp/comments/feed/">Comments (RSS)</a>.
		<!-- 16 queries. 1.037 seconds. -->
	</p>
</div>
</div>

<!-- Gorgeous design by Michael Heilemann - http://binarybonsai.com/kubrick/ -->

		
<script type="text/javascript"><!--
wpa2a.targets=[
{title:'Using Nmap to audit your MySQL database',url:'http://www.cqure.net/wp/2011/06/using-nmap-to-audit-your-mysql-database/'}];
wpa2a.html_done=true;if(wpa2a.script_ready&&!wpa2a.done)wpa2a.init();wpa2a.script_load();
//--></script>

<div style="position:relative;">
	<div class="wp_followme_c2">
		<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="32" height="160" id="wpFollowmeFlash">
			<param name="movie" value="http://www.cqure.net/wp/wp-content/plugins/wp-followme/flash/wp_followme.swf" />
			<param name="allowfullscreen" value="false" />
			<param name="allowscriptaccess" value="always" />
			<param name="flashvars" value="twit_icon=http://www.cqure.net/wp/wp-content/plugins/wp-followme/icons/1.png&amp;turl=http://twitter.com/nevdull77&amp;twitmsg=Follow Me&amp;twitmsgcolor=FFFFFF&amp;iconbgcolor=FFFFFF" />
			<param name="bgcolor" value="#59B7FF" />
			<!--[if !IE]>-->
			<object type="application/x-shockwave-flash" data="../../../../wp-content/plugins/wp-followme/flash/wp_followme.swf" width="32" height="160">
				<param name="allowfullscreen" value="false" />
				<param name="allowscriptaccess" value="always" />
				<param name="flashvars" value="twit_icon=http://www.cqure.net/wp/wp-content/plugins/wp-followme/icons/1.png&amp;turl=http://twitter.com/nevdull77&amp;twitmsg=Follow Me&amp;twitmsgcolor=FFFFFF&amp;iconbgcolor=FFFFFF" />
				<param name="bgcolor" value="#59B7FF" />
				<!--<![endif]-->
				<div class="getflash">
					<a rel="nofollow" href="http://www.adobe.com/go/getflashplayer"><img src="http://www.adobe.com/images/shared/download_buttons/get_flash_player.gif" alt="Get Adobe Flash player" /></a>
									</div><!--[if !IE]>-->
			</object> <!--<![endif]-->
		</object>
	</div>
</div>


<script src="http://www.google-analytics.com/urchin.js" type="text/javascript">
</script>
<script type="text/javascript">
_uacct = "UA-3096101-2";
urchinTracker();
</script>

</body>
</html>
